/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/base/Object","sap/m/p13n/PersistenceProvider","sap/ui/fl/Utils"],function(B,P,F){"use strict";var E="DefaultProviderRegistry: This class is a singleton and should not be used without an AdaptationProvider. Please use 'sap.m.p13n.Engine.getInstance().defaultProviderRegistry' instead";var d;var D=B.extend("sap.m.p13n.modules.DefaultProviderRegistry",{constructor:function(e){if(d){throw Error(E);}B.call(this);this._mDefaultProviders={};this._oEngine=e;}});D.prototype.destroy=function(){Object.keys(this._mDefaultProviders).forEach(function(p){this._mDefaultProviders[p].destroy();delete this._mDefaultProviders[p];}.bind(this));this._oEngine=null;d=null;B.prototype.destroy.apply(this,arguments);};D.prototype.attach=function(e,p){if(this._oEngine.isRegisteredForModification(e)){throw new Error("DefaultProviderRegistry: You must not change the modificationSettings for an already registered element");}var o=typeof e==="string"?sap.ui.getCore().byId(e):e,s=typeof e==="string"?e:e.getId();var a=this._retrieveDefaultProvider(o,p);if(a.getFor().indexOf(s)===-1){a.addFor(e);}return a;};D.prototype.detach=function(c){Object.keys(this._mDefaultProviders).forEach(function(m){var o=this._mDefaultProviders[m];o.removeFor(c);}.bind(this));};D.prototype._retrieveDefaultProvider=function(e,p){if(!this._mDefaultProviders[p]){var o=new P("defaultProviderRegistry"+p,{mode:p});var a=function(){var m=e.getModel(F.VARIANT_MODEL_NAME);if(m){o.setModel(m,F.VARIANT_MODEL_NAME);e.detachEvent("modelContextChange",a);}};e.attachEvent("modelContextChange",a);this._mDefaultProviders[p]=o;}return this._mDefaultProviders[p];};D.getInstance=function(a){if(!d){d=new D(a);}return d;};return D;});
