/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/m/p13n/SelectionController','sap/m/p13n/GroupPanel','sap/m/p13n/modules/xConfigAPI'],function(B,G,x){"use strict";var a=B.extend("sap.m.p13n.subcontroller.GroupController");a.prototype.getStateKey=function(){return"groupLevels";};a.prototype.getCurrentState=function(e){var X=x.readConfig(this.getAdaptationControl())||{};var s=X.hasOwnProperty("properties")?X.properties.groupConditions:[];return s||[];};a.prototype.initAdaptationUI=function(p){var g=new G();var A=this.mixInfoAndState(p);var o=this.getAdaptationControl();if(o.isA("sap.m.Table")){g.setQueryLimit(1);}g.setP13nData(A.items);this._oPanel=g;return Promise.resolve(g);};a.prototype.model2State=function(){var i=[];this._oPanel.getP13nData(true).forEach(function(I){if(I.grouped){i.push({key:I.key});}});return i;};a.prototype.getChangeOperations=function(){return{add:"addGroup",remove:"removeGroup",move:"moveGroup"};};a.prototype._getPresenceAttribute=function(){return"grouped";};a.prototype._createAddRemoveChange=function(c,o,C){var A={selectorElement:c,changeSpecificData:{changeType:o,content:C}};return A;};a.prototype._createMoveChange=function(i,p,n,m,c,P){var M={selectorElement:c,changeSpecificData:{changeType:m,content:{id:i,key:p,index:n}}};if(!P){delete M.changeSpecificData.content.id;}return M;};a.prototype.mixInfoAndState=function(p){var i=this.getCurrentState();var I=this.arrayToMap(i);var c=this.getAdaptationControl();var A=c.getAggregateConditions?c.getAggregateConditions()||{}:{};var P=this.prepareAdaptationData(p,function(m,o){var e=I[o.key];m.grouped=!!e;m.position=e?e.position:-1;return!(o.groupable===false||A[o.key]);});this.sortP13nData({visible:"grouped",position:"position"},P.items);P.presenceAttribute=this._getPresenceAttribute();P.items.forEach(function(o){delete o.position;});return P;};a.prototype.applyChange=function(s){return Promise.resolve();};return a;});
